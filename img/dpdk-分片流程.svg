<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2969" height="4373" viewBox="-0.5 -0.5 2969 4373"><defs><filter id="dropShadow"><feGaussianBlur in="SourceAlpha" stdDeviation="1.7" result="blur"/><feOffset in="blur" dx="3" dy="3" result="offsetBlur"/><feFlood flood-color="#3D4574" flood-opacity="0.4" result="offsetColor"/><feComposite in="offsetColor" in2="offsetBlur" operator="in" result="offsetBlur"/><feBlend in="SourceGraphic" in2="offsetBlur"/></filter></defs><g filter="url(#dropShadow)"><rect x="21" y="0" width="1260" height="450" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 418px; height: 1px; padding-top: 7px; margin-left: 9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: &quot;Droid Sans Mono&quot;, &quot;monospace&quot;, monospace; font-weight: normal; font-size: 14px; line-height: 19px;"><div><span style="color: #4ec9b0;">int32_t</span></div><div><span style="color: #c8c8c8;">rte_ipv4_fragment_packet</span><span style="color: #d4d4d4;">(</span><span style="color: #569cd6;">struct</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">rte_mbuf</span><span style="color: #d4d4d4;"> *</span><span style="color: #7f7f7f;">pkt_in</span><span style="color: #d4d4d4;">,</span></div><div><span style="color: #d4d4d4;">    </span><span style="color: #569cd6;">struct</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">rte_mbuf</span><span style="color: #d4d4d4;"> **</span><span style="color: #7f7f7f;">pkts_out</span><span style="color: #d4d4d4;">,</span></div><div><span style="color: #d4d4d4;">    </span><span style="color: #4ec9b0;">uint16_t</span><span style="color: #d4d4d4;"> </span><span style="color: #7f7f7f;">nb_pkts_out</span><span style="color: #d4d4d4;">,</span></div><div><span style="color: #d4d4d4;">    </span><span style="color: #4ec9b0;">uint16_t</span><span style="color: #d4d4d4;"> </span><span style="color: #7f7f7f;">mtu_size</span><span style="color: #d4d4d4;">,</span></div><div><span style="color: #d4d4d4;">    </span><span style="color: #569cd6;">struct</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">rte_mempool</span><span style="color: #d4d4d4;"> *</span><span style="color: #7f7f7f;">pool_direct</span><span style="color: #d4d4d4;">,</span></div><div><span style="color: #d4d4d4;">    </span><span style="color: #569cd6;">struct</span><span style="color: #d4d4d4;"> </span><span style="color: #4ec9b0;">rte_mempool</span><span style="color: #d4d4d4;"> *</span><span style="color: #7f7f7f;">pool_indirect</span><span style="color: #d4d4d4;">)</span></div></div></div></div></div></foreignObject><text x="9" y="19" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">int32_t...</text></switch></g><path d="M 651 990 L 651 1090.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 1106.65 L 640.5 1085.65 L 651 1090.9 L 661.5 1085.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="810" width="360" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 300px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">合法性检查</div></div></div></foreignObject><text x="217" y="304" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">合法性检查</text></switch></g><path d="M 651 690 L 651 790.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 806.65 L 640.5 785.65 L 651 790.9 L 661.5 785.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="510" width="360" height="180" rx="70.2" ry="70.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 200px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">开始</div></div></div></foreignObject><text x="217" y="204" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">开始</text></switch></g><path d="M 981 810 L 966 810 Q 951 810 951 840 L 951 870 Q 951 900 936 900 L 928.5 900 Q 921 900 936 900 L 943.5 900 Q 951 900 951 930 L 951 960 Q 951 990 966 990 L 981 990" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" transform="translate(951,0)scale(-1,1)translate(-951,0)" pointer-events="all"/><rect x="1011" y="810" width="960" height="180" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 300px; margin-left: 497px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">检查输入数据包、输出分片数组和内存池是否为 NULL，<br />检查输出分片数组的大小是否为 0，<br />以及检查 MTU 的大小是否小于以太网的最小 MTU。</div></div></div></foreignObject><text x="497" y="304" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">检查输入数据包、输出分片数组和内存池是否为 NULL，...</text></switch></g><rect x="471" y="1110" width="360" height="180" fill="#f8cecc" stroke="#b85450" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 400px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">通过原数据包<br />获取IP头部长度</div></div></div></foreignObject><text x="217" y="404" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">通过原数据包&#xa;获取IP头部长度</text></switch></g><path d="M 651 1290 L 651 1468.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 1484.65 L 640.5 1463.65 L 651 1468.9 L 661.5 1463.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="1281" y="75" width="1680" height="300" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 558px; height: 1px; padding-top: 32px; margin-left: 429px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">输入数据包 pkt_in<br />输出分片的数组 pkts_out<br />输出分片数组的大小 nb_pkts_out<br />最大传输单元（MTU）的大小 mtu_size<br />用于分配输出分片的直接和间接缓冲区的内存池 pool_direct 和 pool_indirect。</div></div></div></foreignObject><text x="429" y="44" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">输入数据包 pkt_in...</text></switch></g><path d="M 651 1668 L 651 1768.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 1784.65 L 640.5 1763.65 L 651 1768.9 L 661.5 1763.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="1488" width="360" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 526px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">从direct pool中<br />分配一个mbuf out_pkt</div></div></div></foreignObject><text x="217" y="530" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">从direct pool中...</text></switch></g><path d="M 981 1488 L 966 1488 Q 951 1488 951 1518 L 951 1548 Q 951 1578 936 1578 L 928.5 1578 Q 921 1578 936 1578 L 943.5 1578 Q 951 1578 951 1608 L 951 1638 Q 951 1668 966 1668 L 981 1668" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" transform="translate(951,0)scale(-1,1)translate(-951,0)" pointer-events="all"/><rect x="981" y="1413" width="1110" height="330" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 526px; margin-left: 329px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">direct pool直接存储内存池：struct rte_mbuf后申请了<br />headroom、data、tailroom的空间<br /><br />indirect pool间接存储内存池：只申请了struct rte_mbuf数据结构，<br />其data区域未申请空间 <br /><br />此处从direct pool中申请是为了存放分片的IP首部</div></div></div></foreignObject><text x="329" y="530" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">direct pool直接存储内存池：struct rte_mbuf后申请了...</text></switch></g><path d="M 651 1968 L 651 2038.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 2054.65 L 640.5 2033.65 L 651 2038.9 L 661.5 2033.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="1788" width="360" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 626px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">初始化分片可存放数据的大小</div></div></div></foreignObject><text x="217" y="630" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">初始化分片可存放数据的大小</text></switch></g><path d="M 651.43 2238 L 651.43 2298.43 L 651.43 2268.43 L 651.43 2308.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651.43 2324.65 L 640.93 2303.65 L 651.43 2308.9 L 661.93 2303.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="2058" width="360" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 716px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">从indirect pool中<br style="border-color: var(--border-color);" />分配一个mbuf out_seg</div></div></div></foreignObject><text x="217" y="720" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">从indirect pool中...</text></switch></g><path d="M 981 1788 L 966 1788 Q 951 1788 951 1818 L 951 1848 Q 951 1878 936 1878 L 928.5 1878 Q 921 1878 936 1878 L 943.5 1878 Q 951 1878 951 1908 L 951 1938 Q 951 1968 966 1968 L 981 1968" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" transform="translate(951,0)scale(-1,1)translate(-951,0)" pointer-events="all"/><rect x="1011" y="1833" width="420" height="90" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 626px; margin-left: 339px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">大小为MTU-头部长度</div></div></div></foreignObject><text x="339" y="630" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">大小为MTU-头部长度</text></switch></g><path d="M 981 2058 L 966 2058 Q 951 2058 951 2088 L 951 2118 Q 951 2148 936 2148 L 928.5 2148 Q 921 2148 936 2148 L 943.5 2148 Q 951 2148 951 2178 L 951 2208 Q 951 2238 966 2238 L 981 2238" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" transform="translate(951,0)scale(-1,1)translate(-951,0)" pointer-events="all"/><rect x="1011" y="2058" width="780" height="180" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 716px; margin-left: 339px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">此处从indirect pool中申请是因为分片的数据<br />可以用 指向原数据包相应位置的指针 表示，<br />既省空间又省去数据包的拷贝操作</div></div></div></foreignObject><text x="339" y="720" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">此处从indirect pool中申请是因为分片的数据...</text></switch></g><path d="M 651 2508 L 651 2578.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 2594.65 L 640.5 2573.65 L 651 2578.9 L 661.5 2573.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="2328" width="360" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 806px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">将上一个mbuf的next字段指向当前这个分配的mbuf</div></div></div></foreignObject><text x="217" y="810" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">将上一个mbuf的next字段指向当前这个分配的mbuf</text></switch></g><path d="M 651 2778 L 651 2848.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 2864.65 L 640.5 2843.65 L 651 2848.9 L 661.5 2843.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="2598" width="360" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 896px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">计算分片长度<br />将该分片的数据指向原数据包相应位置</div></div></div></foreignObject><text x="217" y="900" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">计算分片长度&#xa;将该分片的数据指向原数据包相应位置</text></switch></g><path d="M 366 3033 L 201.43 3033 L 201.43 1998.43 L 631.9 1998.02" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 647.65 1998 L 626.66 2008.52 L 631.9 1998.02 L 626.64 1987.52 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1012px; margin-left: 97px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">N</div></div></div></foreignObject><text x="97" y="1016" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">N</text></switch></g><path d="M 651 3198 L 651 3295.81" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 3311.56 L 640.5 3290.56 L 651 3295.81 L 661.5 3290.56 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1082px; margin-left: 218px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">Y</div></div></div></foreignObject><text x="218" y="1085" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">Y</text></switch></g><path d="M 651 2868 L 936 3033 L 651 3198 L 366 3033 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 188px; height: 1px; padding-top: 1011px; margin-left: 123px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">分片长度是否<br />达到MTU<br />or<br />原数据包是否<br style="border-color: var(--border-color);" />全部分划完成</div></div></div></foreignObject><text x="217" y="1015" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">分片长度是否达到MTU...</text></switch></g><path d="M 651 3494.91 L 651 3565.81" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 3581.56 L 640.5 3560.56 L 651 3565.81 L 661.5 3560.56 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="3314.91" width="360" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1135px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">填充out_pkt头部的各种信息</div></div></div></foreignObject><text x="217" y="1139" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">填充out_pkt头部的各种信息</text></switch></g><path d="M 1026 3314.91 L 1011 3314.91 Q 996 3314.91 996 3344.91 L 996 3374.91 Q 996 3404.91 981 3404.91 L 973.5 3404.91 Q 966 3404.91 981 3404.91 L 988.5 3404.91 Q 996 3404.91 996 3434.91 L 996 3464.91 Q 996 3494.91 1011 3494.91 L 1026 3494.91" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" transform="translate(996,0)scale(-1,1)translate(-996,0)" pointer-events="all"/><rect x="1056" y="3344.91" width="600" height="120" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1135px; margin-left: 354px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">如分片偏移、源、目的等，<br />通过memcpy从原数据包拷贝实现</div></div></div></foreignObject><text x="354" y="1139" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">如分片偏移、源、目的等，&#xa;通过memcpy从原数据包拷贝实现</text></switch></g><path d="M 471 3974.91 L 21.43 3975 L 21.43 1392.43 L 631.9 1392.01" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 647.65 1392 L 626.65 1402.52 L 631.9 1392.01 L 626.64 1381.52 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1326px; margin-left: 113px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">N</div></div></div></foreignObject><text x="113" y="1330" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">N</text></switch></g><path d="M 651 4094.91 L 651 4165.81" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 4181.56 L 640.5 4160.56 L 651 4165.81 L 661.5 4160.56 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1378px; margin-left: 219px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">Y</div></div></div></foreignObject><text x="219" y="1381" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">Y</text></switch></g><path d="M 651 3854.91 L 831 3974.91 L 651 4094.91 L 471 3974.91 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1325px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">原数据包是否<br />全部分划完成</div></div></div></foreignObject><text x="217" y="1329" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">原数据包是否&#xa;全部分划完成</text></switch></g><path d="M 981 2328 L 966 2328 Q 951 2328 951 2358 L 951 2388 Q 951 2418 936 2418 L 928.5 2418 Q 921 2418 936 2418 L 943.5 2418 Q 951 2418 951 2448 L 951 2478 Q 951 2508 966 2508 L 981 2508" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" transform="translate(951,0)scale(-1,1)translate(-951,0)" pointer-events="all"/><rect x="1011" y="2373" width="840" height="90" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 806px; margin-left: 339px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">以链表的方式将一个分片的各个数据段连接起来</div></div></div></foreignObject><text x="339" y="810" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">以链表的方式将一个分片的各个数据段连接起来</text></switch></g><path d="M 651 3764.91 L 651 3835.81" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 651 3851.56 L 640.5 3830.56 L 651 3835.81 L 661.5 3830.56 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="471" y="3584.91" width="360" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1225px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">将out_pkt的地址写入输出的分片数组 pkts_out</div></div></div></foreignObject><text x="217" y="1229" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">将out_pkt的地址写入输出的分片数组 pkts_out</text></switch></g><rect x="471" y="4184.91" width="360" height="180" rx="70.2" ry="70.2" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1425px; margin-left: 158px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">结束，输出分片数组与分片数量</div></div></div></foreignObject><text x="217" y="1429" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">结束，输出分片数组与分片数量</text></switch></g><path d="M 981 1110 L 966 1110 Q 951 1110 951 1140 L 951 1170 Q 951 1200 936 1200 L 928.5 1200 Q 921 1200 936 1200 L 943.5 1200 Q 951 1200 951 1230 L 951 1260 Q 951 1290 966 1290 L 981 1290" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" transform="translate(951,0)scale(-1,1)translate(-951,0)" pointer-events="all"/><rect x="981" y="1155" width="870" height="90" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(2.9999999999999996)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 400px; margin-left: 329px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">通过修改字段偏移可修改为支持CCSDS的分片函数</div></div></div></foreignObject><text x="329" y="404" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">通过修改字段偏移可修改为支持CCSDS的分片函数</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>